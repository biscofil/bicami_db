
var _modal;var editing_old_id;var table;var __modal_edit_title,__modal_new_title;var __xhr_delete,__delete_msg;function adminInit(c,e,b,d,a){__modal_edit_title=e;__modal_new_title=c;myDataTableCall(b);__xhr_delete=d;__delete_msg=a}function myDataTableCall(a){table=$("#datatable").DataTable({language:{url:__base_url+"public/DataTables-1.10.12/Italian.json"},bProcessing:true,bServerSide:true,searchDelay:350,sAjaxSource:__site_url+"/"+__xhr_controller+"/"+a,bJQueryUI:true,sPaginationType:"full_numbers",fnServerData:function(b,c,d){$.getJSON(b,c,function(e){d(e)})},createdRow:function(d,c,b){$(d).attr("id","_"+c[0]);$(d).attr("data-id",c[0])},error:function(c,d,b){if(d==="timeout"){$.notify("The server took too long to send the data.","warning")}else{$.notify("An error occurred on the server. Please try again in a minute.","warning")}table.fnProcessingIndicator(false)}})}function myDeleteCall(d,c){var b=[];$(".selected").each(function(e){b.push($(this).data("id"))});var a=b.length;bootbox.confirm("Procedere con l'eliminazione di "+(a===1?"un elemento":a+" elementi")+"?",function(e){if(e){$.ajax({type:"POST",cache:false,url:__site_url+"/"+__xhr_controller+"/"+d,data:{ids:b},statusCode:{404:function(){$.notify("404","error")}}}).done(function(f){if(f.result===1){table.ajax.reload(null,false);$.notify(c,"success")}else{$.notify(f.error,"error")}}).fail(function(){$.notify("ERRORE","error")})}})}function check_update_delete(){var a=$("tr.selected").length;$("#btn_delete,.one_plus_item").prop("disabled",a<1);$("#btn_edit,.only_one_item").prop("disabled",a!==1)}function clear_selection(){$("tr.selected").removeClass("selected");check_update_delete()}function requiredFieldsCheck(){var a=true;$("form").find(".form-control").each(function(){if($(this).prop("required")){if(!$(this).val()){var b=$(this).closest("label").text()+"";var c=b.replace(/\:/i,"");$.notify(c+" NECESSARIO","error");a=false;$(this).closest(".form-group").addClass("has-error")}else{$(this).closest(".form-group").removeClass("has-error")}}});return a}$(document).ready(function(){_modal=$("#exampleModal");$("#btn_delete").click(function(){myDeleteCall(__xhr_delete,__delete_msg)});$("#btn_edit").click(function(){_modal.find("#btn_save").addClass("hidden");_modal.find("#btn_update").removeClass("hidden");_modal.find("#exampleModalLabel").text(__modal_edit_title);$(".form-group").removeClass("has-error")});$("#btn_new").click(function(){_modal.modal("show");_modal.find("#btn_update").addClass("hidden");_modal.find("#btn_save").removeClass("hidden");_modal.find("#exampleModalLabel").text(__modal_new_title);_modal.find(".form-group").removeClass("has-error");_modal.find(".form-control").val("").trigger("change").prop("checked",false)});$("#datatable").on("page",function(){clear_selection()});$("#datatable").on("search.dt",function(){clear_selection()});$("#datatable").on("order.dt",function(){clear_selection()});$("#datatable").on("draw.dt",function(){check_update_delete()});$("#datatable").on("click","tr",function(){$(this).toggleClass("selected");check_update_delete()})});